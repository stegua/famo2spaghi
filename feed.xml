<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://stegua.github.io/famo2spaghi/feed.xml" rel="self" type="application/atom+xml" /><link href="https://stegua.github.io/famo2spaghi/" rel="alternate" type="text/html" /><updated>2020-03-30T16:40:48-05:00</updated><id>https://stegua.github.io/famo2spaghi/feed.xml</id><title type="html">Spaghetti Optimization 2.0</title><subtitle>My cookbook about Math, Algorithms, and Programming</subtitle><entry><title type="html">Is the Covid Curve Flattening in Italy?</title><link href="https://stegua.github.io/famo2spaghi/jupyter/2020/03/30/is-the-covid-curve-flattening-in-italy.html" rel="alternate" type="text/html" title="Is the Covid Curve Flattening in Italy?" /><published>2020-03-30T00:00:00-05:00</published><updated>2020-03-30T00:00:00-05:00</updated><id>https://stegua.github.io/famo2spaghi/jupyter/2020/03/30/is-the-covid-curve-flattening-in-italy</id><content type="html" xml:base="https://stegua.github.io/famo2spaghi/jupyter/2020/03/30/is-the-covid-curve-flattening-in-italy.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-30-is-the-covid-curve-flattening-in-italy.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;About&quot;&gt;About&lt;a class=&quot;anchor-link&quot; href=&quot;#About&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;This notebook explains how to fit the &lt;a href=&quot;https://github.com/pcm-dpc/COVID-19&quot;&gt;Italian open-data&lt;/a&gt; about the spread of #covid19 using a &lt;a href=&quot;https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology&quot;&gt;Susceptible-Infectious-Recovered (SIR) model&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Data fitting&lt;/strong&gt; is modeled and solved using Nonlinear Constrained Optimization via &lt;a href=&quot;http://www.pyomo.org/&quot;&gt;Pyomo&lt;/a&gt; and &lt;a href=&quot;https://github.com/coin-or/Ipopt&quot;&gt;IPOPT&lt;/a&gt;.
&lt;div class=&quot;flash flash-warn&quot;&gt;
    &lt;svg class=&quot;octicon octicon-zap&quot; viewBox=&quot;0 0 10 16&quot; version=&quot;1.1&quot; width=&quot;10&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M10 7H6l3-7-9 9h4l-3 7 9-9z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Important: &lt;/strong&gt;I am neither a medical doctor nor an epidemiologist. I am just a &lt;em&gt;mathematical optimizer&lt;/em&gt;, and this post is about a didactic example of data fitting via Mathematical Optimization.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Runnig-this-notebook-on-Colab&quot;&gt;Runnig this notebook on Colab&lt;a class=&quot;anchor-link&quot; href=&quot;#Runnig-this-notebook-on-Colab&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Run the following snippet if you arre running this notebook in &lt;a href=&quot;https://colab.research.google.com/&quot;&gt;Colab&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;shutil&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os.path&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shutil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;pyomo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pip install -q pyomo
    &lt;span class=&quot;k&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shutil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;pyomo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shutil&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;which&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ipopt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ipopt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;google.colab&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modules&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;apt-get install -y -qq glpk-utils
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;conda install -c conda-forge ipopt 
        &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;The-SIR-model:-The-Elegance-of-Simplicity&quot;&gt;The SIR model: The Elegance of Simplicity&lt;a class=&quot;anchor-link&quot; href=&quot;#The-SIR-model:-The-Elegance-of-Simplicity&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The &lt;strong&gt;Susceptible-Infectious-Recovered (SIR)&lt;/strong&gt; model is a classical epidemic model that is used to describe rapid outbreaks that occur in less than a year. For a complete survey on the SIR and related models, we recommend reading the SIAM Review by Herbert W. Hethcote entitled &lt;a href=&quot;https://epubs.siam.org/doi/pdf/10.1137/S0036144500371907&quot;&gt;The Mathematics of Infectious
Diseases&lt;/a&gt;. The next paragraphs are based on that very nice paper.&lt;/p&gt;
&lt;p&gt;In this post, we will not enter into details of all those models, but we will focus on the basic equations that can be used to capture the main trend of the Covid19 outbreak in Italy at the time of writing.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Continuous-Time-Model&quot;&gt;Continuous Time Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Continuous-Time-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;SIR model&lt;/strong&gt; consider a population of $N$ individuals partiotioned into three groups: (i), Susceptible, (ii) Infectious, and (iii) Recovered. The number of individuals at time $t$ is each group is denoted by $S(t)$, $I(t)$, and $R(t)$, respectively. Since the model do not consider births and deaths, we have at any time of outbreak:
$$
    N = S(t) + I(t) + R(t).
$$&lt;/p&gt;
&lt;p&gt;The dynamics of an outbreak is described by the SIR model via the following ordinary differential equations:&lt;/p&gt;
$$
\frac{dS}{dt} = -\frac{\beta}{N}IS, \;\;\;\;\;\;\;\;\;  S(0) \geq 0
$$$$
\frac{dI}{dt} = \frac{\beta}{N}IS - \gamma I, \;\;\; I(0) \geq 0
$$$$
\frac{dR}{dt} = \gamma I, \;\;\;\;\;\;\;\;\;\;\;\;\;\;\; R(0) \geq 0
$$&lt;p&gt;Where $S(0), I(0), R(0)$ are the initial group sizes at the begging of the outbreak. The parameter $\beta$ is the average number of contacts of a person per unit of time, while $\frac{1}{\gamma}$ is the mean infectious period.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;A very important parameter is the &lt;strong&gt;basic reproduction number $R_0$&lt;/strong&gt; defined as
$$
R_0 = \frac{\beta}{\gamma}
$$
which is defined in [1] as the average number of secondary infections produced when one infected individual is introduced into a host population where everyone is susceptible.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Discrete-Time-Model&quot;&gt;Discrete Time Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Discrete-Time-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The previous model can be discretized thus obtaining the following &lt;strong&gt;discrete time model&lt;/strong&gt;:&lt;/p&gt;
$$
S(t+1) = S(t) - \frac{\beta}{N} I(t) S(t), 
$$$$
I(t+1) = I(t) + \frac{\beta}{N} S(t) I(t) - \gamma I(t), 
$$$$
R(t+1) = R(t) + \gamma I(t)
$$&lt;p&gt;Intuitively, we have that proportion of individuals moving at unit of time $t+1$ from the suscetible group $S$ to the infected groups $I$ is equal to $\frac{\beta}{N} I(t) S(t)$. The proportion of individuals moving at unit of time $t+1$ from the infected group $I$ to the recovered groups $R$ is equal to $\gamma I(t)$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The dynamic of the system is completely described by the two parameters $\beta$ and $\gamma$, and the initial conditions $S(0)$, $I(0)$, and $R(0)$.
&lt;div class=&quot;flash flash-warn&quot;&gt;
    &lt;svg class=&quot;octicon octicon-zap octicon octicon-zap&quot; viewBox=&quot;0 0 10 16&quot; version=&quot;1.1&quot; width=&quot;10&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M10 7H6l3-7-9 9h4l-3 7 9-9z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Important: &lt;/strong&gt;The goal of this post is to present a data fitting approach to estimate the two parameters $\gamma$ and $\beta$, given the data of an outbreak which is not yet concluded. That is, we have reasonable good estimate of $I(t)$ and $R(t)$ for all $t \leq \bar t$, but we have to estimate those values for $t \geq \bar t$.
&lt;/div&gt;
As a side effect, we can get the value of the important parameter $R_0$.&lt;/p&gt;
&lt;p&gt;And all this happen by solving a Nonlinear Constrained Optimization problem using Python in a Colab.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Data-Fitting-via-Constrained-Optimization&quot;&gt;Data Fitting via Constrained Optimization&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-Fitting-via-Constrained-Optimization&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The Italian government is updating every day on GitHub a detailed report of the situation of the &lt;a href=&quot;https://github.com/pcm-dpc/COVID-19&quot;&gt;COVID19 outbreak in Italy&lt;/a&gt;: this is a very important source of data for every scientist.&lt;/p&gt;
&lt;p&gt;In particular, since February, 24th, 2020, we have the number of official cases (infected persons) the number of recovered, and the number of deaths. We are interested specifically on the number of new infected by day, which is only implicitly contained in the database.&lt;/p&gt;
&lt;p&gt;Another important source of data is the &lt;a href=&quot;https://www.kaggle.com/c/covid19-global-forecasting-week-2&quot;&gt;Kaggle Covid Dataset&lt;/a&gt;, which contains t&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Is-the-Curve-Flattening?&quot;&gt;Is the Curve Flattening?&lt;a class=&quot;anchor-link&quot; href=&quot;#Is-the-Curve-Flattening?&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;License&quot;&gt;License&lt;a class=&quot;anchor-link&quot; href=&quot;#License&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a rel=&quot;license&quot; href=&quot;http://creativecommons.org/licenses/by-nc-sa/4.0/&quot;&gt;&lt;img alt=&quot;Creative Commons License&quot; style=&quot;border-width:0&quot; src=&quot;https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png&quot; /&gt;&lt;/a&gt;&lt;br /&gt;This work is licensed under a &lt;a rel=&quot;license&quot; href=&quot;http://creativecommons.org/licenses/by-nc-sa/4.0/&quot;&gt;Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://stegua.github.io/famo2spaghi/images/chart-preview.png" /><media:content medium="image" url="https://stegua.github.io/famo2spaghi/images/chart-preview.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>